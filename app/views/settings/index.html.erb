<h1>Settings</h1>

<div class="card mt-4">
  <div class="card-body">
    <h5 class="card-title">Registration Settings</h5>

    <%= form_tag settings_path, method: :post, class: 'form' do %>
      <div class="form-group">
        <div class="custom-control custom-switch">
          <%= check_box_tag :registration_open, 1, @registration_open, class: 'custom-control-input', id: 'registration_open_switch' %>
          <%= label_tag :registration_open, 'Registration Open', class: 'custom-control-label', for: 'registration_open_switch' %>
        </div>
        <small class="form-text text-muted">
          When enabled, new users can register based on the selected registration types below. When disabled, only godmothers can access the registration pages.
        </small>
      </div>

      <div class="form-group">
        <label>Registration Types</label>
        <div class="custom-control custom-checkbox">
          <%= check_box_tag 'registration_types[]', 'mentee', @registration_types.include?('mentee'), class: 'custom-control-input', id: 'registration_type_mentee' %>
          <%= label_tag 'registration_type_mentee', 'Mentee', class: 'custom-control-label' %>
        </div>
        <div class="custom-control custom-checkbox">
          <%= check_box_tag 'registration_types[]', 'mentor', @registration_types.include?('mentor'), class: 'custom-control-input', id: 'registration_type_mentor' %>
          <%= label_tag 'registration_type_mentor', 'Mentor', class: 'custom-control-label' %>
        </div>
        <small class="form-text text-muted">
          Select which types of users can register. At least one type must be selected when registration is open.
        </small>
      </div>

      <div class="form-group">
        <%= button_tag 'Save Settings', type: 'submit', class: 'btn btn-primary' %>
      </div>
    <% end %>
  </div>
</div>

<div class="card mt-4">
  <div class="card-body">
    <h5 class="card-title">Ticket Confirmation Reminders</h5>
    <p class="text-muted">
      Send reminder emails to all mentees and mentors who have not yet confirmed their ticket status.
      This action will only send one reminder per user.
    </p>
    <%= form_tag settings_send_ticket_reminders_path, method: :post, class: 'form' do %>
      <div class="form-group">
        <%= button_tag "Send Ticket Reminders (#{@pending_ticket_reminders_count})", type: 'submit', class: 'btn btn-warning',
            data: { confirm: "Are you sure you want to send ticket confirmation reminders to #{@pending_ticket_reminders_count} user#{'s' if @pending_ticket_reminders_count != 1}?" } %>
      </div>
    <% end %>
  </div>
</div>

<div class="card mt-4">
  <div class="card-body">
    <h5 class="card-title">Export Registration Data</h5>
    <p class="text-muted">
      Export all registration data for mentees and mentors as a CSV file.
    </p>
    <div class="form-group">
      <%= link_to 'Export All Registrations', settings_export_csv_path, class: 'btn btn-success' %>
      <%= link_to 'Export Matchable Participants', settings_export_matchable_csv_path, class: 'btn btn-info ml-2' %>
    </div>
    <small class="form-text text-muted">
      "Matchable Participants" are those in waiting state and with a confirmed conference ticket.
    </small>
  </div>
</div>
